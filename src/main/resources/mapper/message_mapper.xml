<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.cod.app.message.mapper.MessageMapper">

	<select id="messageList"
		resultType="vofile.MessageVO">
		SELECT MESSAGE_SEQ,
		MESSAGE_TITLE,
		MESSAGE_CONTENT,
		ADMIN_ID,
		SEND_RECEIVE,READ
		FROM MESSAGE
		WHERE ADMIN_ID = #{adminId}
		ORDER BY MESSAGE_SEQ DESC
	</select>

	<select id="getMessage"
		resultType="vofile.MessageVO"
		parameterType="vofile.MessageVO">
		SELECT MESSAGE_CONTENT FROM
		MESSAGE WHERE MESSAGE_SEQ =
		#{messageSeq}
	</select>

	<insert id="insertMessage"
		parameterType="vofile.MessageVO">
		INSERT INTO MESSAGE(
		MESSAGE_SEQ,
		MESSAGE_TITLE,
		MESSAGE_CONTENT,
		ADMIN_ID,
		SEND_RECEIVE)
		VALUES ((select nvl(max(message_seq),0)+1 from message),
		#{messageTitle},
		#{messageContent},
		#{adminId},
		#{sendReceive}
		)
	</insert>

	<update id="updateMessage" parameterType="int">  <!-- 메세지 읽음, 읽지않음 -->
		UPDATE MESSAGE
		SET
		read=0
		WHERE MESSAGE_SEQ=#{messageSeq} AND ADMIN_ID=${adminId}
	</update>

	<select id="getMessageCount" parameterType="vofile.MessageVO" resultType="int">
		SELECT NVL(COUNT(READ),0) FROM MESSAGE
		WHERE READ=1 AND ADMIN_ID=#{adminId}
	</select>


</mapper>