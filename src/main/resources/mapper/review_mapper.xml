<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="co.cod.app.review.mapper.ReviewMapper">
	<!-- 단건조회  -->
	<select id="getReview" parameterType="co.cod.app.review.ReviewVO" resultType="co.cod.app.review.ReviewVO">
		SELECT 
		        review_seq,
		        email,
				review_content,
				review_time,
				stars,
				order_seq,
				photo_group,
				gdsThumbImg,
				admin_id
						
		 		
		FROM review
		WHERE review_seq = #{reviewSeq}
	</select>

	<!-- <resultMap type="#modelname" id="YourResultSet">
		<id property="param1" column="columnname1" />
		<result property="param2" column="columnname2" />
		<result property="param3" column="columnname3" />
	</resultMap> -->

	<!-- 전체조회  -->
	<select id="getReviewList" resultType="co.cod.app.review.ReviewVO">
		SELECT c.cafe_name, o.*, r.review_seq, r.review_content, r.review_time, r.stars, r.photo_group, r.gdsThumbImg
        from orders o, cafe c, review r 
        where c.admin_id= o.admin_id 
        and c.admin_id = r.admin_id
        order by review_seq
	</select>

	<insert id="insertReview" parameterType="co.cod.app.review.ReviewVO">
		INSERT INTO review (review_seq, review_content, review_time, stars, gdsThumbImg)  
		
		VALUES ((select nvl(max(review_seq),0)+1 from review), #{reviewContent}, sysdate, #{stars}, #{gdsThumbImg})
	</insert>

 	<update id="updateReview" parameterType="co.cod.app.review.ReviewVO">
		UPDATE review 
		SET
			    review_content = #{reviewContent}, 
			    stars = #{stars},
			    gdsThumbImg = #{gdsThumbImg}
		where   review_seq = #{reviewSeq}
	</update>

	<delete id="deleteReview" parameterType="co.cod.app.review.ReviewVO">
		DELETE FROM review 
		WHERE
		review_seq = #{reviewSeq}
	</delete>
</mapper>
