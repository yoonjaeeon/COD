<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="co.cod.app.seat.mapper.SeatMapper">
	<!-- 페이징 카운트 갯수 -->
	<select id ="getCount" resultType="int">
	SELECT count(*)
        from seat
	</select>
	<!-- 단건조회  -->
	<select id="getSeat" parameterType="co.cod.app.seat.SeatVO" resultType="co.cod.app.seat.SeatVO">
		SELECT 
		        seat_seq,
		        seat_name,
				seat_img,
				seat_reserve,
				admin_id,
				seat_size		 		
		FROM Seat
		WHERE Seat_seq = #{seatSeq}
	</select>

	<!-- <resultMap type="#modelname" id="YourResultSet">
		<id property="param1" column="columnname1" />
		<result property="param2" column="columnname2" />
		<result property="param3" column="columnname3" />
	</resultMap> -->  
	
	<!-- 전체조회  -->
	<select id="getSeatList"  resultType="co.cod.app.seat.SeatVO">
	SELECT B.* FROM ( SELECT A.*, ROWNUM rn FROM (
		SELECT *
        from seat
        order by seat_seq desc
         ) A ) B WHERE rn BETWEEN #{start} AND #{end}
	</select>

	<insert id="insertSeat" parameterType="co.cod.app.seat.SeatVO">
		INSERT INTO Seat (seat_seq, seat_name, seat_img, seat_size, admin_id)  
		
		VALUES ((select nvl(max(seat_seq),0)+1 from seat), #{seatName}, #{seatImg}, #{seatSize}, #{adminId})
	</insert>

 	<update id="updateSeat" parameterType="co.cod.app.seat.SeatVO">
		UPDATE Seat 
		<set>
			    seat_name = #{seatName},
			    seat_size = #{seatSize},
			   <if test = "seatImg != null and seatImg != ''">
			    	seat_img = #{seatImg}
			   </if>
		</set>	    
		where seat_seq = #{seatSeq}
	</update>

	<delete id="deleteSeat" parameterType="co.cod.app.seat.SeatVO">
		DELETE FROM seat 
		WHERE
		Seat_seq = #{seatSeq}
	</delete>
</mapper>
